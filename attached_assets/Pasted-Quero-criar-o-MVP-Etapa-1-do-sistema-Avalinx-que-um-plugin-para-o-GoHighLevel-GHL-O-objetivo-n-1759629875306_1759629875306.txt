Quero criar o MVP Etapa 1 do sistema Avalinx, que Ã© um plugin para o GoHighLevel (GHL).
O objetivo nesta etapa Ã© apenas conectar o Avalinx ao GHL via OAuth2 e confirmar a conexÃ£o, sem nenhuma funcionalidade adicional.
Siga as seguintes instruÃ§Ãµes cuidadosamente para construir o projeto com arquitetura limpa, boas prÃ¡ticas e estrutura pronta para crescer.

ğŸ§± Arquitetura geral

Crie o projeto com a seguinte estrutura de diretÃ³rios:

avalinx/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ .env.example
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ server.js
â”‚   â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.js
â”‚   â”‚   â””â”€â”€ services/
â”‚   â”‚       â””â”€â”€ ghl.js
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ tokens.js
â”‚   â””â”€â”€ README.md
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ README.md
â”œâ”€â”€ .gitignore
â””â”€â”€ README.md


O frontend ainda nÃ£o serÃ¡ desenvolvido â€” apenas reserve a pasta.

âš™ï¸ ConfiguraÃ§Ã£o do backend

Stack:

Node.js 18+

Express.js (ou Fastify)

Nodemon (dev)

Dotenv

Axios (para requisiÃ§Ãµes ao GHL)

CORS

Scripts em package.json:

{
  "name": "avalinx-backend",
  "version": "0.0.1",
  "main": "src/server.js",
  "scripts": {
    "start": "node src/server.js",
    "dev": "nodemon src/server.js"
  },
  "dependencies": {
    "axios": "^1.7.2",
    "cors": "^2.8.5",
    "dotenv": "^16.4.5",
    "express": "^4.19.2"
  },
  "devDependencies": {
    "nodemon": "^3.1.0"
  }
}

ğŸ” VariÃ¡veis de ambiente (.env.example)
PORT=3000
GHL_CLIENT_ID=coloque_aqui
GHL_CLIENT_SECRET=coloque_aqui
GHL_REDIRECT_URI=http://localhost:3000/auth/callback


No Replit, vocÃª pode configurar essas variÃ¡veis em Secrets.
Quando migrar para Railway, copie-as para o painel de â€œEnvironment Variablesâ€.

ğŸ”— Rotas necessÃ¡rias
/auth/ghl

Redireciona o usuÃ¡rio para o consentimento OAuth do GoHighLevel.

Exemplo URL:

https://marketplace.gohighlevel.com/oauth/chooselocation?response_type=code&redirect_uri=<redirect_uri>&client_id=<client_id>

/auth/callback

Recebe o code do GHL.

Faz POST https://services.leadconnectorhq.com/oauth/token com client_id, client_secret, code e redirect_uri.

Salva access_token, refresh_token e expires_in em memÃ³ria (simule o DB).

Retorna JSON:

{
  "connected": true,
  "locationId": "xxxxx",
  "access_token": "xxxxx"
}

/me

Usa o access_token para chamar GET https://services.leadconnectorhq.com/locations
(ou outro endpoint pÃºblico) e confirma que o token estÃ¡ vÃ¡lido.

Retorna informaÃ§Ãµes bÃ¡sicas da conta GHL conectada.

ğŸ§© Estrutura de cÃ³digo sugerida
src/server.js

Configura Express, CORS, dotenv.

Importa as rotas de routes/auth.js.

Usa process.env.PORT || 3000.

Endpoint raiz (/) retorna {status: "Avalinx API Online"}.

src/routes/auth.js

Define as rotas /auth/ghl, /auth/callback e /me.

Chama funÃ§Ãµes do serviÃ§o services/ghl.js.

src/services/ghl.js

ContÃ©m as funÃ§Ãµes:

getAuthUrl()

exchangeCodeForToken(code)

getUserData(accessToken)

utils/tokens.js

Armazena tokens em memÃ³ria (objeto local).
Exemplo:

const tokens = new Map();
export function saveToken(locationId, data) { tokens.set(locationId, data); }
export function getToken(locationId) { return tokens.get(locationId); }

ğŸ§  Boas prÃ¡ticas que devem ser seguidas

Usar try/catch com respostas JSON amigÃ¡veis.

Nunca logar tokens completos no console.

Configurar .gitignore com:

node_modules
.env


Adicionar comentÃ¡rios explicando o fluxo OAuth.

Incluir README.md com instruÃ§Ãµes de instalaÃ§Ã£o:

npm install
npm run dev
Acesse /auth/ghl para iniciar a conexÃ£o

ğŸ§© Resultado esperado (MVP Etapa 1)

ApÃ³s rodar:

npm install
npm run dev


VocÃª deve conseguir acessar:

http://localhost:3000/auth/ghl â†’ abrir o login do GoHighLevel

Autorizar â†’ redireciona para /auth/callback â†’ salva tokens em memÃ³ria

GET /me â†’ retorna dados bÃ¡sicos da conta GHL

âœ… Isso confirma que o Avalinx jÃ¡ conecta ao GHL com sucesso,
pronto para na prÃ³xima etapa gerar links e placar.